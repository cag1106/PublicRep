#!/usr/bin/make -f

DPKG_EXPORT_BUILDFLAGS = 1
-include /usr/share/dpkg/buildflags.mk

# This double-negative means "please install development files"
CMAKE_INSTALL_FLAG = -DCABLE_NO_INSTALL_FACILITIES:BOOL=OFF

CMAKE_FLAGS = $(CMAKE_INSTALL_FLAG) \
	-DCMAKE_CXX_COMPILER:STRING=g++ \
	-DCMAKE_BUILD_TYPE:STRING=RELEASE \
	-DCMAKE_SKIP_RPATH:BOOL=ON \
	-DCSWIG_USE_SYSTEM_GCCXML:BOOL=ON \
	-DGCCXML_PATH:FILEPATH=/usr/bin/gccxml

pkg_run = cableswig
pkg_dev = libcableswig-dev


%:
	dh $@ --buildsystem=cmake --parallel

get-orig-source:
	uscan --force-download --repack

override_dh_auto_configure:
	dh_auto_configure -- $(CMAKE_FLAGS)

override_dh_install:
	# Runtime Package
	dh_install -p$(pkg_run) usr/bin
	dh_install -p$(pkg_run) usr/lib/CableSwig
	# Development Package
	dh_install -p$(pkg_dev) usr/include
	dh_install -p$(pkg_dev) --autodest usr/lib/lib*.a
